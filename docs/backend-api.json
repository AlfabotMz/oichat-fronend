{"openapi":"3.0.3","info":{"title":"OiChat MVP API","description":"API para gerenciar agentes e conversas do OiChat.","version":"0.1.0"},"components":{"schemas":{}},"paths":{"/":{"get":{"responses":{"200":{"description":"Default Response"}}}},"/api/agent/":{"post":{"summary":"Create a new agent","tags":["Agent"],"requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"userId":{"type":"string","format":"uuid"},"status":{"type":"string","enum":["ACTIVE","INACTIVE"],"default":"ACTIVE"},"name":{"type":"string","minLength":1},"description":{"type":"string","minLength":1},"prompt":{"type":"string","minLength":1}},"required":["userId","name","description","prompt"],"additionalProperties":false}}},"required":true},"responses":{"200":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"userId":{"type":"string","format":"uuid"},"status":{"type":"string","enum":["ACTIVE","INACTIVE"],"default":"ACTIVE"},"name":{"type":"string","minLength":1},"description":{"type":"string","minLength":1},"prompt":{"type":"string","minLength":1},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}},"required":["id","userId","status","name","description","prompt","createdAt","updatedAt"],"additionalProperties":false}}}},"400":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"},"details":{"type":"object","additionalProperties":true}},"required":["error","details"],"additionalProperties":false}}}},"500":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"},"details":{"type":"object","additionalProperties":true}},"required":["error","details"],"additionalProperties":false}}}}}}},"/api/agent/{id}":{"get":{"summary":"Get an agent by its ID","tags":["Agent"],"description":"Fetches a single agent from the database or cache.","parameters":[{"schema":{"type":"string","format":"uuid"},"in":"path","name":"id","required":true}],"responses":{"200":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"schema":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"userId":{"type":"string","format":"uuid"},"status":{"type":"string","enum":["ACTIVE","INACTIVE"],"default":"ACTIVE"},"name":{"type":"string","minLength":1},"description":{"type":"string","minLength":1},"prompt":{"type":"string","minLength":1},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}},"required":["id","userId","status","name","description","prompt","createdAt","updatedAt"],"additionalProperties":false}}}}}},"404":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"schema":{"type":"object","properties":{"error":{"type":"string"},"details":{"type":"object","additionalProperties":true}},"required":["error","details"],"additionalProperties":false}}}}}}}},"patch":{"summary":"Update an existing agent","tags":["Agent"],"description":"Updates one or more properties of an agent.","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"string","enum":["ACTIVE","INACTIVE"],"default":"ACTIVE"},"name":{"type":"string","minLength":1},"description":{"type":"string","minLength":1},"prompt":{"type":"string","minLength":1}},"additionalProperties":false}}}},"parameters":[{"schema":{"type":"string","format":"uuid"},"in":"path","name":"id","required":true}],"responses":{"200":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"userId":{"type":"string","format":"uuid"},"status":{"type":"string","enum":["ACTIVE","INACTIVE"],"default":"ACTIVE"},"name":{"type":"string","minLength":1},"description":{"type":"string","minLength":1},"prompt":{"type":"string","minLength":1},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}},"required":["id","userId","status","name","description","prompt","createdAt","updatedAt"],"additionalProperties":false}}}},"400":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"},"details":{"type":"object","additionalProperties":true}},"required":["error","details"],"additionalProperties":false}}}},"404":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"},"details":{"type":"object","additionalProperties":true}},"required":["error","details"],"additionalProperties":false}}}}}}},"/api/agent{id}":{"delete":{"summary":"Delete an agent","tags":["Agent"],"description":"Permanently deletes an agent and invalidates its cache.","parameters":[{"schema":{"type":"string","format":"uuid"},"in":"path","name":"id","required":true}],"responses":{"204":{"description":"Agent deleted successfully"},"404":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"},"details":{"type":"object","additionalProperties":true}},"required":["error","details"],"additionalProperties":false}}}}}}},"/api/agent/conversation/{id}/{conversationId}":{"delete":{"summary":"Clear conversation history","tags":["Conversation"],"description":"Deletes the entire message history for a specific conversation from Redis.","parameters":[{"schema":{"type":"string","format":"uuid"},"in":"path","name":"id","required":true,"description":"The agent ID"},{"schema":{"type":"string"},"in":"path","name":"conversationId","required":true,"description":"The unique ID for the conversation (e.g., a user JID)"}],"responses":{"200":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string"}}}}}}}}},"/api/agent/conversation/{id}":{"post":{"summary":"Interact with an agent","tags":["Conversation"],"description":"Send a message to an agent and receive an AI-generated response. The conversation history is used for context.","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"content":{"type":"string","minLength":1},"fromMe":{"type":"boolean"},"conversationId":{"type":"string","format":"uuid"}},"required":["id","content","fromMe","conversationId"],"additionalProperties":false}}},"required":true},"parameters":[{"schema":{"type":"string","format":"uuid"},"in":"path","name":"id","required":true,"description":"The agent ID"}],"responses":{"200":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"content":{"type":"string","minLength":1},"fromMe":{"type":"boolean"},"conversationId":{"type":"string","format":"uuid"}},"required":["id","content","fromMe","conversationId"],"additionalProperties":false}}}},"400":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"},"details":{"type":"object","additionalProperties":true}},"required":["error","details"],"additionalProperties":false}}}}}}},"/api/webhook/{id}":{"post":{"parameters":[{"schema":{"type":"string"},"in":"path","name":"id","required":true}],"responses":{"200":{"description":"Default Response"}}}},"/api/whatsapp/create":{"post":{"summary":"Create a WhatsApp instance","tags":["Whatsapp"],"requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"instance":{"type":"string","description":"The name of the instance to create."},"agentId":{"type":"string","description":"The id off the agent that will connect","format":"uuid"}},"required":["instance"],"additionalProperties":false}}},"required":true},"responses":{"200":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"ok":{"type":"boolean"}}}}}},"400":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"}},"required":["error"]}}}},"500":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"}},"required":["error"]}}}}}}},"/api/whatsapp/connect":{"post":{"summary":"Connect a WhatsApp instance","tags":["Whatsapp"],"description":"Gets a QR code or pairing code to connect an instance.","requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"instance":{"type":"string","description":"The name of the instance to connect."}},"required":["instance"],"additionalProperties":false}}},"required":true},"responses":{"200":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"object","properties":{"pairingCode":{"type":"string"},"code":{"type":"string"},"count":{"type":"number"}},"required":["pairingCode","code","count"]}},"required":["data"]}}}},"500":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"}},"required":["error"]}}}}}}},"/api/whatsapp/check/{instanceName}":{"get":{"summary":"Check instance connection status","tags":["Whatsapp"],"parameters":[{"schema":{"type":"string"},"in":"path","name":"instanceName","required":true}],"responses":{"200":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"isConnected":{"type":"boolean"}},"required":["isConnected"]}}}},"500":{"description":"Default Response","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string"}},"required":["error"]}}}}}}}},"tags":[{"name":"Agent","description":"Agent management endpoints"},{"name":"Conversation","description":"Conversation and memory endpoints"}]}
